mkdir -p ~/.kube/users
cd .kube/users/

openssl genrsa -out devops.key 2048

openssl req -new -key devops.key -out devops.csr -subj "/CN=devops/O=devops/O=4labs.example"

sudo openssl x509 -req -CA /etc/kubernetes/pki/ca.crt -CAkey /etc/kubernetes/pki/ca.key -CAcreateserial -days 365 -in devops.csr -out devops.crt

kubectl config set-credentials devops --client-certificate=devops.crt --client-key=devops.key

kubectl config set-context devops --cluster=kubernetes --user=devops --namespace=4labs

kubectl config get-contexts

### Criar configuração para o usuário

kubectl config view --flatten --minify | awk '/contexts:/{exit}1' > config
cat config

cat /home/suporte/1750/docker-kubernetes/security/context/config-devops
cat /home/suporte/1750/docker-kubernetes/security/context/config-devops >> config

cat config

scp config devops.crt devops.key devops@registry:
